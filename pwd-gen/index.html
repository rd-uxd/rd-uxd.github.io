<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Password Generator</title>
<link href="css/style.css" rel="stylesheet">
<link rel="shortcut icon" href="favicon.png">
<script src="js/crypt.js" language="javascript"></script>
<script language="javascript">

function compute() {
	var password;
	if (document.getElementById('special').checked) {
		password = b64_sha1(document.getElementById('master').value +':'+ document.getElementById('site').value).substr(0,8);
		password = password.replace(/[^a-zA-Z0-9]/g,'0');
		password = password + 'aZ0$';
	}
	else {
		password = b64_sha1(document.getElementById('master').value +':'+ document.getElementById('site').value).substr(0,9);
		password = password.replace(/[^a-zA-Z0-9]/g,'0');
		password = password + 'aZ0';
	}
	copyToClipboard(password);
	document.getElementById('password').value = 'Password = ' + password;
}

function clearPassword() {
	document.getElementById('password').value = "";
}	

function clearAll() {
	document.getElementById('password').value = "";
	document.getElementById('site').value = "";
	document.getElementById('master').value = "";
	document.getElementById('master').focus();
}

function copyToClipboard(text) {
	if (window.clipboardData && window.clipboardData.setData) {
		return clipboardData.setData("Text", text); 	
	}
	else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
		var textarea = document.createElement("textarea");
		textarea.textContent = text;
		textarea.style.position = "fixed";
		document.body.appendChild(textarea);
		textarea.select();
		try {
			return document.execCommand("copy");
		}
		catch (ex) {
			console.warn("Copy to clipboard failed.", ex);
			return false;
		}
		finally {
			document.body.removeChild(textarea);
		}
	}
}
</script>
</head>
<body>

<div>
	<h3>Password generator</h3>
	<div>
		<input class="input-prop" size='30' type="password" name="master" id="master" placeholder="Master password" autofocus onKeyDown="clearPassword();"/>
	</div>

	<div style="margin-top:10px;">
		<input class="input-prop" size='30' type="text" name="site" id="site" placeholder="Site such as facebook.com" autocorrect="off" autocapitalize="off"  onkeydown="clearPassword();"/>
	</div>

	<div style="margin-top:10px;">
		<label><input type="checkbox" value="" id="special" onClick="clearPassword();"/>Include special character in password</label>
	</div>

	<div style="margin-top:10px;">
		<button type="button" id="generate" onClick="compute();">Generate and copy password</button>
	</div>

	<div style="margin-top:10px;">
		<input readonly="readonly" class="input-mono" size='30' type="text" name="password" id="password" placeholder="Password"/>
	</div>

	<div style="margin-top:10px;">
		<button type="button" onClick="clearAll();">Clear fields</button>
	</div>
</div>

</body>
</html>
